<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="OpenJPEG, current, changes, changelog" />
    <meta name="description" content="Log of changes in the package" />
    <link rel="stylesheet" type="text/css" href="../../../css/common.css" />
    <link rel="stylesheet" type="text/css" href="../../../css/changelog.css" />
    
    
    <title>
        OpenJPEG current: changelog
    </title>
    
    </head>

<body>
<table cellpadding='0' cellspacing='0'><tr><td align='center'><h1 class='tool'><a title='Home: ABI tracker for OpenJPEG' href='../../../timeline/openjpeg/index.html' class='tool'>ABI<br/>Tracker</a></h1></td><td width='30px;'></td><td><h1>(OpenJPEG)</h1></td></tr></table><hr/>
<br/>
<br/>
<h1>Changelog from Git</h1><br/><br/>
<div class='changelog'>
<pre class='wrap'>commit fdcd4e6365731cc1015213e424068131bcd1f31f
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-24 13:23:25 +0200

    Remove -NR-DEC-p1_06.j2k-156-decode and NR-DEC-p1_06.j2k-164-decode from knownfailures
    
    and make them explicit failures. The result images are empty at the requested resolution

commit bc71bd1219269057ea18e6acbc77a96ec37aba82
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-23 18:58:32 +0200

    opj_dwt_decode_partial_97(): perf improvement: limit copy of coefficients at end of horizontal pass to actual range of interest

commit 8180eeace13ffceef5dd7c3f80be156e36181846
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-21 23:06:53 +0200

    test_tile_encoder: fix checks on argc

commit c97666f72ba26a7ceb64931963b988a6f8f377f9
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-21 19:02:04 +0200

    j2k.c: fix comment, and remove FIXME

commit 24d069e3ffa2286930a2e7e2638431ea1de6846a
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-21 17:19:13 +0200

    Add comment

commit e9bbc6d3dde946bdb5195f053f24b91335d5d84c
Merge: 3eed024 17a7ac4
Author: Even Rouault &lt;even.rouault@mines-paris.org&gt;
Date:   2017-08-21 13:02:07 +0200

    Merge pull request #1001 from rouault/subtile_decoding_stage2
    
    Subtile decoding: only apply IDWT on areas that participate to the window of interest

commit 17a7ac42d581c537cfc1da4324e53047ad82b13e
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-21 12:25:38 +0200

    Add comments for filter_width values

commit f87c5ef7ebef3d7a908e98f2de1b6a0336ae57ae
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-20 22:02:41 +0200

    Subtile decoding: only do 9x7 IDWT computations on relevant areas of tile-component buffer.

commit 3eed024eb45534f86537404e08d08fa572a40782
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-19 15:45:54 +0200

    pgxtoimage(): avoid excessive memory allocation attempt (#999)

commit 5d403250561398f7ba3041d9eb8c893bd680dd72
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-18 15:08:51 +0200

    Subtile decoding: only do 5x3 IDWT computations on relevant areas of tile-component buffer.
    
    This lowers 'bin/opj_decompress -i ../MAPA.jp2 -o out.tif -d 0,0,256,256'
    down to 0.860s

commit e5285319229a5d77bf316bb0d3a6cbd3cb8666d9
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-18 13:39:20 +0200

    pgxtoimage(): fix write stack buffer overflow (#997)

commit 028c504a43e962a725c4fd73d6642ee73c653e1b
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-18 12:30:11 +0200

    test_decode_area: fix to make it work with odd image dimensions

commit 5597522cac96b1bc6d48a447751b1c6049248eef
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-18 10:16:38 +0200

    bmp_read_rle8_data(): avoid potential infinite loop (#996)

commit 5d12806091eab0659431fefcefdb797b09f8e884
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-17 19:18:48 +0200

    opj_j2k_update_rates(): grow tile size buffer for some situations

commit 4b0bfbfabc3ce1cc4c6d18dc7113b9f6335372d4
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-17 16:07:19 +0200

    Zero-initialize tile buffer regions of skipped code-blocks, so as to make Valgrind happy

commit fe338a057c39797bf61939471ebaef09e44464c7
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-14 13:23:57 +0200

    Sub-tile decoding: only decode precincts and codeblocks that intersect the window specified in opj_set_decode_area()

commit 17ea17f487a777d14bd322ac06c4e6cb9124a226
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-17 19:05:29 +0200

    Fix -Wconversion warning

commit fd8448ed446a935da3210821a783e794ede3c599
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-17 17:04:48 +0200

    bench_dwt.c: fix signedness related warnings

commit da046b73a89806eae2f7f461c2a46bda7e07aaa8
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-17 17:02:40 +0200

    convert.c: fix recently introduced -Wsign-conversion warnings

commit 9f7d79fd30df3712e6bfc6d475bfa143c069c4df
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-17 14:52:10 +0200

    opj_getopt_long(): avoid infinite loop on invalid or missing value for an option (#736)

commit 1ab6e0e07a67193564811c5720a69cb28f09a809
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-17 12:01:16 +0200

    opj_decompress_fuzzer.cpp: reject images with too big tiles. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2918. Credit to OSS Fuzz

commit 2cd30c2b06ce332dede81cccad8b334cde997281
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-17 11:47:40 +0200

    tgatoimage(): avoid excessive memory allocation attempt, and fixes unaligned load (#995)

commit 09e83407fa2b53c606d3179031b8d8b31272e20c
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-17 11:05:53 +0200

    Avoid asserting on assert(i == pcol) in opj_jp2_apply_pclr() by adding new check in opj_jp2_check_color(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3068. Credit to OSS Fuzz

commit 8e6c371e66d9c579048fd336cc3365869486080a
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-16 18:29:59 +0200

    opj_t1_encode_cblk(): avoid uint32 overflow when numbps = 0 (which is well defined behaviour, and is properly handled here, but better avoid it to detect real issues)

commit 1e387de74273c4dac618df94475556541c1caf3e
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-16 17:38:47 +0200

    Fix build issue of JPWL by adding opj_image_data_alloc() and opj_image_data_free() to src/lib/openmj2 (#994)

commit c535531f03369623b9b833ef41952c62257b507e
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-16 17:20:29 +0200

    opj_t2_encode_packet(): fix potential write heap buffer overflow (#992)

commit dcac91b8c72f743bda7dbfa9032356bc8110098a
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-16 17:09:10 +0200

    opj_j2k_write_sot(): fix potential write heap buffer overflow (#991)

commit af760007711bf93041d3eba3a41b9a48d365f303
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-16 13:36:52 +0200

    tiftoimage(): fix read heap buffer overflow (#988)
    
    The number of components is given only by TIFFTAG_SAMPLESPERPIXEL / tiSpp.
    Querying TIFFTAG_EXTRASAMPLES only give information about which channel is
    the alpha channel, but we mostly ignore it for now, so remove that part of the
    code.

commit ab4de904e7dc1deee83122cd2bf6e0e7f4eb2eb0
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-16 13:11:36 +0200

    imagetotga(): fix read heap buffer overflow if numcomps &lt; 3 (#987)

commit 9624b2fa4722edf77fbac631e7dacaae12c91672
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-16 12:52:33 +0200

    opj_t2_encode_packet(): only emit an error about insufficiently large output buffer in FINAL_PASS mode. Fixes (master-only) regression added in 0b4fef6d1901254e41ab74ed681daba477d724c3

commit 4241ae6fbbf1de9658764a80944dc8108f2b4154
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-15 11:55:58 +0200

    Fix assertion in debug mode / heap-based buffer overflow in opj_write_bytes_LE for Cinema profiles with numresolutions = 1 (#985)

commit 52d5690a6fcba86b5f117eeac8aca1971cac3688
Merge: baf0c1a bc59410
Author: Even Rouault &lt;even.rouault@mines-paris.org&gt;
Date:   2017-08-14 17:28:26 +0200

    Merge pull request #984 from stweil/const
    
    Use more const qualifiers

commit baf0c1ad4572daa89caa3b12985bdd93530f0dd7
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-14 17:26:58 +0200

    bmp_read_info_header(): reject bmp files with biBitCount == 0 (#983)

commit afb308b9ccbe129608c9205cf3bb39bbefad90b9
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-14 17:20:37 +0200

    Encoder: grow buffer size in opj_tcd_code_block_enc_allocate_data() to avoid write heap buffer overflow in opj_mqc_flush (#982)

commit bc59410f253b0cd3d4818ec06ce957cbdbfe4341
Author: Stefan Weil &lt;sw@weilnetz.de&gt;
Date:   2017-08-14 14:36:06 +0200

    Use const qualifier for mqc_states
    
    This allows more compiler optimizations.
    
    Signed-off-by: Stefan Weil &lt;sw@weilnetz.de&gt;

commit 10e6ce2c2cfacf51fdde7e9c69bf2365840f4bb0
Author: Stefan Weil &lt;sw@weilnetz.de&gt;
Date:   2017-08-13 22:57:31 +0200

    Use const qualifier for j2k_prog_order_list
    
    This allows more compiler optimizations.
    
    Signed-off-by: Stefan Weil &lt;sw@weilnetz.de&gt;

commit 0b4c3ce75d11600ebc6675bd871f78ca3c95bc60
Merge: a35b489 9f75088
Author: Even Rouault &lt;even.rouault@mines-paris.org&gt;
Date:   2017-08-11 15:13:35 +0200

    Merge pull request #980 from szukw000/changes-for-ppc64-converttif
    
    Changes in converttif.c for PPC64

commit 9f750884f91a4f1b9ca3e6a401057c21a7e2bd99
Author: szukw000 &lt;szukw000@arcor.de&gt;
Date:   2017-08-11 00:06:23 +0200

    Changes in converttif.c for PPC64

commit a35b4891340dcecf2b248c7e57a90bf7d7aa9b2f
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-10 16:58:36 +0200

    Fix argument order in error message of previous commit

commit 0b4fef6d1901254e41ab74ed681daba477d724c3
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-10 16:49:47 +0200

    Propagate event manager down to opj_t2_encode_packet() and use it to emit an error message when the output buffer is too small

commit a316f36dfc7cc4217bfce0ac6d23b47f90cf8fd9
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-10 14:43:16 +0200

    Fix crash on encoding if using opj_set_default_encoder_parameters() without defining tcp_numlayers

commit a4c938181deb2cb48e408ac6e358062927060125
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-10 12:30:31 +0200

    Reformat tests/test_tile_encoder.c

commit 26fe8f60433aa677fd29590e7da23437c41e99c8
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-10 11:45:49 +0200

    Improve doc of opj_tccp_info_t::cblkw and cblkh

commit 07c2fe28b0ef3dc9f168f2b2c449275ac1dde981
Author: Antonin Descampe &lt;antonin@gmail.com&gt;
Date:   2017-08-09 21:51:16 -0700

    Comment back previous version in abi-check.sh

commit c5987173c5ca2d6fb140dd84d7ae7736824e6d66
Author: Antonin Descampe &lt;antonin@gmail.com&gt;
Date:   2017-08-09 21:35:30 -0700

    update abi-check for latest release

commit 3d7cde5fc9fbc5618d02160900d32e02ed12a00e
Author: Antonin Descampe &lt;antonin@descampe.net&gt;
Date:   2017-08-09 17:31:50 -0700

    Preparing Release v2.2.0

commit bc21818c635f1f84aa72bb327a20ca42c3b6dcbe
Author: Antonin Descampe &lt;antonin@gmail.com&gt;
Date:   2017-08-09 17:28:17 -0700

    Preparing Release v2.2.0

commit c03fbbee6399d6a996f484015035d5996ce80f9a
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-10 01:14:35 +0200

    .travis.yml: add 'dist: precise' for config that requires it

commit 4b16e8d27ae524c5bf5f8af299703f7334752465
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-09 17:37:05 +0200

    Remove useless opj_tcd_t::enumcs field added per #975

commit 5e200452db84947f4eb893ae7f02f7dd9a358378
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-09 15:04:29 +0200

    Doc: fix error in previous commit

commit 9203e8ec51a1c1c1a358a9cbafdf3391549ebc80
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-09 14:50:59 +0200

    tcd.h: doc fixes and improvements

commit 11b1ffb373d8e41705348080ba5e74a4ffe4148c
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-09 14:13:58 +0200

    Document qmfbid values

commit ac375ac9f5b4ae47501b60795e905e3d25dd00f8
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-09 11:34:08 +0200

    Partial revert BPC related check of #975 (#979)
    
    PR #975 introduced a check that rejects images that have different bit depth/sign
    per compoment in SIZ marker if the JP2 IHDR box has BPC != 255
    This didn't work properly if decoding a .j2k file since the new bit added in
    opj_cp_t wasn't initialized to the right value.
    For clarity, tThis new bit has also been renamed to allow_different_bit_depth_sign
    
    But looking closer at the code, it seems we were already tolerant to inconsistencies.
    For example we parsed a JP2 BPCC box even if BPC != 255 (just a warning is emitted)
    So failing hard in opj_j2k_read_siz() wouldn't be very inconsistent, and that
    alone cannot protect against other issues, so just emit a warning if BPC != 255
    and the SIZ marker contains different bit depth/sign per component.
    
    Note: we could also check that the content of JP2 BPCC box is consistant with the one
    of the SIZ marker.

commit c38bdbef4f3a5888948903247532fc8cf4284c00
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-09 10:03:59 +0200

    opj_decompress: document -quiet option, and remove spurious newline output

commit 0eceb4494c23d141ddf242209b92f07bc942b437
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-09 09:50:39 +0200

    src/bin/jpwl/convert.c pgxtoimage(): add missing fclose() (#977)

commit 5a560ebf5138ebc241e9962306ce74bfc50fc69c
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-09 09:42:30 +0200

    imagetobmp: avoid shift by -1 (relates to #811)

commit 0c07950cb3f318df5b2051ae5d96bef553bb9966
Author: Antonin Descampe &lt;antonin@gmail.com&gt;
Date:   2017-08-08 18:05:37 -0700

    Fix remaining warning
    
    format specifier mismatch in #975

commit 0394f8d0f1c981e0bc587beddc14d1fb0b265b1b
Merge: 3b1b067 bc3cb74
Author: Antonin Descampe &lt;antonin@descampe.net&gt;
Date:   2017-08-08 16:51:54 -0700

    Merge pull request #975 from szukw000/changes-for-afl-tests
    
    Catch images broken by AFL

commit 3b1b0672663b59853b63d48f94b63ca497883527
Merge: 2fbd4bb 9211469
Author: Even Rouault &lt;even.rouault@mines-paris.org&gt;
Date:   2017-08-07 20:17:36 +0200

    Merge pull request #968 from rouault/reduce_memory_decoding
    
    Reduce memory decoding

commit 92114694a48638e86c07e4adf11b78878045c8a9
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-07-06 19:34:21 +0200

    Slight improvement in management of code block chunks
    
    Instead of having the chunk array at the segment level, we can move it down to
    the codeblock itself since segments are filled in sequential order.
    Limit the number of memory allocation, and decrease slightly the memory usage.
    
    On MAPA_005.jp2
    
    n4: 1871312549 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
     n1: 1610689344 0x4E781E7: opj_aligned_malloc (opj_malloc.c:61)
      n1: 1610689344 0x4E71D1B: opj_alloc_tile_component_data (tcd.c:676)
       n1: 1610689344 0x4E726CF: opj_tcd_init_decode_tile (tcd.c:816)
        n1: 1610689344 0x4E4BE39: opj_j2k_read_tile_header (j2k.c:8617)
         n1: 1610689344 0x4E4C902: opj_j2k_decode_tiles (j2k.c:10348)
          n1: 1610689344 0x4E4E3CE: opj_j2k_decode (j2k.c:7846)
           n1: 1610689344 0x4E53002: opj_jp2_decode (jp2.c:1564)
            n0: 1610689344 0x40374E: main (opj_decompress.c:1459)
     n1: 219232541 0x4E4BC50: opj_j2k_read_tile_header (j2k.c:4683)
      n1: 219232541 0x4E4C902: opj_j2k_decode_tiles (j2k.c:10348)
       n1: 219232541 0x4E4E3CE: opj_j2k_decode (j2k.c:7846)
        n1: 219232541 0x4E53002: opj_jp2_decode (jp2.c:1564)
         n0: 219232541 0x40374E: main (opj_decompress.c:1459)
     n1: 23893200 0x4E72735: opj_tcd_init_decode_tile (tcd.c:1225)
      n1: 23893200 0x4E4BE39: opj_j2k_read_tile_header (j2k.c:8617)
       n1: 23893200 0x4E4C902: opj_j2k_decode_tiles (j2k.c:10348)
        n1: 23893200 0x4E4E3CE: opj_j2k_decode (j2k.c:7846)
         n1: 23893200 0x4E53002: opj_jp2_decode (jp2.c:1564)
          n0: 23893200 0x40374E: main (opj_decompress.c:1459)
     n0: 17497464 in 52 places, all below massif's threshold (1.00%)

commit bc3cb7410023e9d0c7ff9972a0bc8cf1fe9b32a4
Author: szukw000 &lt;szukw000@arcor.de&gt;
Date:   2017-08-07 16:44:28 +0200

    Changes for converttif.c to fix tsize_t

commit 2fbd4bb0b9c6178f12c852dc40db6ab05734bfe2
Author: Even Rouault &lt;even.rouault@spatialys.com&gt;
Date:   2017-08-04 18:01:29 +0200

    opj_j2k_read_sot(): check current TPSot number regarding previous (non-zero) TNsot to avoid opj_j2k_merge_ppt() to be called several times. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2851. Credit to OSS Fuzz

commit 57e36dbfeb57451444c5c20eab66ab0bedd3d3b3
Author: szukw000 &lt;szukw000@arcor.de&gt;
Date:   2017-08-02 17:27:08 +0200

    First change on changes-for-afl-tests

...</pre></div>

</body>
</html>
